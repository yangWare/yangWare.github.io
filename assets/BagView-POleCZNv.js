import{_ as O,f as y,s as o,e as r,c as i,o as l,a as n,h as P,F as b,r as h,t as g,A as j,B as D,u as F}from"./main-BmL1Ibci.js";import{p as S,m as v}from"./potion_config-xlKXEzcY.js";import{M as T,i as U}from"./Message-Bnt8fvlJ.js";const z={class:"bag-container"},G={class:"materials-grid"},J=["onClick"],Q={class:"material-name"},R={class:"potions-grid"},W=["onClick"],X={class:"potion-name"},Y={class:"unequipped-grid"},Z=["onClick"],K={class:"item-name"},ee={__name:"BagView",setup(te){const x=s=>{for(const e in v.material_types){const t=v.material_types[e];if(t.materials[s])return t.materials[s].name}return s},C=y(()=>(o.player.materials||[]).map(e=>({id:e,name:x(e)}))),M=y(()=>(o.player.potions||[]).map(e=>{const t=S.potions[e];return{id:e,name:t.name,description:t.description,effect:t.effect}})),q=y(()=>o.player.unequipped||[]),c=r(!1),p=r(""),m=r("info"),$=U.combat_stats,B=s=>{for(const e in v.material_types){const t=v.material_types[e];if(t.materials[s]){const a=t.materials[s],u=t.base_stats,E=a.multiplier;let k="";for(const[w,H]of Object.entries(u))k+=`${$[w]||w}: ${H*E}<br>`;return{name:a.name,level:a.level,type:t.name,stats:k.trim()}}}return null},I=s=>{const e=B(s.id);e&&(p.value=`${e.name}<br>类型: ${e.type}<br>等级: ${e.level}<br>属性加成:<br>${e.stats}`,m.value="info",c.value=!0,d.value=!1)},L=s=>{p.value=`${s.name}<br>${s.description}<br>效果: ${s.effect.type==="hp"?"恢复生命值":s.effect.type} ${s.effect.value}`,m.value="info",c.value=!0,d.value=!0,f.value="使用";const e=()=>A(s);_.value=e},A=async s=>{const e=[...o.player.potions],t=e.indexOf(s.id);t>-1&&e.splice(t,1);let a=o.player.hp;if(s.effect.type==="hp"){const u=D();a=Math.min(o.player.hp+s.effect.value,u)}await F({...o.player,hp:a,potions:e})},N=s=>{let e=`${s.name}<br>`;for(const[a,u]of Object.entries(s.combat_info||{}))e+=`${$[a]||a}: ${u}<br>`;p.value=e.trim(),m.value="info",c.value=!0,d.value=!0,f.value="穿戴";const t=()=>j(s.name);_.value=t},d=r(!1),f=r("确定"),_=r(()=>{}),V=()=>{_.value()};return(s,e)=>(l(),i("div",z,[e[1]||(e[1]=n("div",{class:"section-title"},"材料",-1)),n("div",G,[(l(!0),i(b,null,h(C.value,t=>(l(),i("div",{key:t.id,class:"material-item",onClick:a=>I(t)},[n("div",Q,g(t.name),1)],8,J))),128))]),e[2]||(e[2]=n("div",{class:"section-title"},"药品",-1)),n("div",R,[(l(!0),i(b,null,h(M.value,t=>(l(),i("div",{key:t.id,class:"potion-item",onClick:a=>L(t)},[n("div",X,g(t.name),1)],8,W))),128))]),e[3]||(e[3]=n("div",{class:"section-title"},"未穿戴装备",-1)),n("div",Y,[(l(!0),i(b,null,h(q.value,t=>(l(),i("div",{key:t.name,class:"unequipped-item",onClick:a=>N(t)},[n("div",K,g(t.name),1)],8,Z))),128))]),P(T,{visible:c.value,"onUpdate:visible":e[0]||(e[0]=t=>c.value=t),content:p.value,type:m.value,"show-button":d.value,"button-text":f.value,onAction:V},null,8,["visible","content","type","show-button","button-text"])]))}},oe=O(ee,[["__scopeId","data-v-54a26145"]]);export{oe as default};
